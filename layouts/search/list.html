{{ define "main" }}
<div style="padding: 20px; max-width: 1000px; margin: 0 auto; font-family: Arial, sans-serif;">
    <h1 style="color: #27ae60; text-align: center;">ğŸ” å¤šè‚½æ•°æ®åº“æœç´¢</h1>
    
    <!-- æœç´¢æ¡† -->
    <div style="background: #f0f8f0; padding: 30px; border-radius: 10px; margin: 20px 0; text-align: center;">
        <form action="/search/" method="get">
            <input 
                type="text" 
                name="q" 
                id="searchInput" 
                value="{{ .Params.q }}"
                placeholder="è¾“å…¥å…³é”®è¯æœç´¢ï¼ˆå¤šè‚½åç§°ã€åºåˆ—ã€é¶ç‚¹ã€ä½œè€…ç­‰ï¼‰..." 
                style="width: 80%; padding: 15px; font-size: 16px; border: 2px solid #27ae60; border-radius: 25px; outline: none;"
                autofocus
            >
            <button 
                type="submit" 
                style="padding: 15px 30px; background: #27ae60; color: white; border: none; border-radius: 25px; margin-left: 10px; cursor: pointer;"
            >
                æœç´¢
            </button>
        </form>
    </div>

    {{ if .Params.q }}
    <!-- æœç´¢ç»“æœ -->
    <div id="searchResults">
        {{ $query := .Params.q | lower }}
        {{ $peptides := .Site.Data.peptides }}
        
        <!-- ä½¿ç”¨ findRE å‡½æ•°è¿›è¡Œæœç´¢ -->
        {{ $results := slice }}
        {{ range $index, $row := $peptides }}
            {{ $match := false }}
            {{ $fields := slice $row.å¤šè‚½åç§° $row.å¤šè‚½åºåˆ—N_Cç«¯ $row.å¤šè‚½é¶ç‚¹ $row.ä½œè€… }}
            {{ range $fields }}
                {{ if . }}
                    {{ if findRE $query (lower .) }}
                        {{ $match = true }}
                    {{ end }}
                {{ end }}
            {{ end }}
            {{ if $match }}
                {{ $results = $results | append (dict "index" $index "row" $row) }}
            {{ end }}
        {{ end }}
        
        <div style="background: #e8f5e8; padding: 15px; border-radius: 5px; margin: 20px 0;">
            <p>æœç´¢ "<strong>{{ .Params.q }}</strong>" æ‰¾åˆ° <strong>{{ len $results }}</strong> æ¡ç»“æœ</p>
        </div>
        
        {{ if gt (len $results) 0 }}
        <table style="width: 100%; border-collapse: collapse; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
            <thead>
                <tr style="background-color: #27ae60; color: white;">
                    <th style="padding: 15px; text-align: left;">å¤šè‚½åç§°</th>
                    <th style="padding: 15px; text-align: left;">åºåˆ—</th>
                    <th style="padding: 15px; text-align: left;">é¶ç‚¹</th>
                    <th style="padding: 15px; text-align: left;">äº²å’ŒåŠ›</th>
                    <th style="padding: 15px; text-align: left;">æ“ä½œ</th>
                </tr>
            </thead>
            <tbody>
                {{ range $results }}
                {{ $row := .row }}
                <tr style="border-bottom: 1px solid #eee;">
                    <td style="padding: 12px;">
                        <a href="/peptides/{{ .index }}/" style="color: #27ae60; text-decoration: none; font-weight: bold;">
                            {{ $row.å¤šè‚½åç§° }}
                        </a>
                    </td>
                    <td style="padding: 12px; font-family: monospace;">
                        <code>{{ $row.å¤šè‚½åºåˆ—N_Cç«¯ }}</code>
                    </td>
                    <td style="padding: 12px;">{{ $row.å¤šè‚½é¶ç‚¹ }}</td>
                    <td style="padding: 12px;">{{ $row.äº²å’ŒåŠ› }}</td>
                    <td style="padding: 12px;">
                        <a href="/peptides/{{ .index }}/" style="color: #2196F3; text-decoration: none;">æŸ¥çœ‹è¯¦æƒ…</a>
                    </td>
                </tr>
                {{ end }}
            </tbody>
        </table>
        {{ else }}
        <div style="text-align: center; padding: 50px; color: #666;">
            <p>ğŸ˜” æ²¡æœ‰æ‰¾åˆ°åŒ¹é… "{{ .Params.q }}" çš„ç»“æœ</p>
            <p>è¯·å°è¯•å…¶ä»–å…³é”®è¯æˆ–æ£€æŸ¥æ‹¼å†™</p>
        </div>
        {{ end }}
    </div>
    {{ else }}
    <!-- æœç´¢æç¤º -->
    <div style="text-align: center; color: #666; padding: 50px;">
        <p>ğŸ” è¯·è¾“å…¥å…³é”®è¯å¼€å§‹æœç´¢</p>
        <p>å¯ä»¥æœç´¢ï¼šå¤šè‚½åç§°ã€åºåˆ—ç‰‡æ®µã€é¶ç‚¹åç§°ã€ä½œè€…ç­‰</p>
    </div>
    {{ end }}
</div>

<script>
// ç®€å•çš„å®¢æˆ·ç«¯æœç´¢å¢å¼º
document.addEventListener('DOMContentLoaded', function() {
    const searchInput = document.getElementById('searchInput');
    if (searchInput && !searchInput.value) {
        searchInput.focus();
    }
});
</script>
{{ end }}
