<!DOCTYPE html>
<html lang="zh-CN">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ•°æ®å¯¼å‡º - å¤šè‚½æ•°æ®åº“</title>
    <link rel="stylesheet" href="http://localhost:1313/css/custom.css">
    <style>
         
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 200px;
        }
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #27ae60;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        
        <header style="background: linear-gradient(135deg, #27ae60, #2ecc71); color: white; padding: 20px; border-radius: 0 0 10px 10px; margin-bottom: 30px;">
            <h1 style="margin: 0; font-size: 2em;">
                <a href="/" style="color: white; text-decoration: none;">ğŸ§¬ å¤šè‚½æ•°æ®åº“</a>
            </h1>
            <nav style="margin-top: 15px;">
                <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                    <a href="/" class="btn btn-outline" style="border-color: white; color: white;">é¦–é¡µ</a>
                    <a href="/peptides/" class="btn btn-outline" style="border-color: white; color: white;">æµè§ˆæ•°æ®</a>
                    <a href="/search/" class="btn btn-outline" style="border-color: white; color: white;">æœç´¢</a>
                    <a href="/filter/" class="btn btn-outline" style="border-color: white; color: white;">ç­›é€‰</a>
                    <a href="/export/" class="btn btn-outline" style="border-color: white; color: white;">å¯¼å‡º</a>
                </div>
            </nav>
        </header>
        
        
        <main>
            
<div style="padding: 20px; max-width: 1000px; margin: 0 auto; font-family: Arial, sans-serif;">
    <h1 style="color: #27ae60; text-align: center;">ğŸ“¥ æ•°æ®å¯¼å‡º</h1>
    
    <div style="background: #f0f8f0; padding: 30px; border-radius: 10px; margin: 20px 0;">
        <h3>å¯¼å‡ºé€‰é¡¹</h3>
        
        <div style="background: white; padding: 20px; border-radius: 8px; margin: 15px 0;">
            <h4>ğŸ”¸ å¯¼å‡ºèŒƒå›´</h4>
            <div>
                <input type="radio" id="exportAll" name="exportScope" value="all" checked>
                <label for="exportAll">å…¨éƒ¨æ•°æ®</label>
            </div>
            <div style="margin-top: 10px;">
                <input type="radio" id="exportCurrent" name="exportScope" value="current">
                <label for="exportCurrent">å½“å‰ç­›é€‰ç»“æœ</label>
            </div>
        </div>
        
        <div style="background: white; padding: 20px; border-radius: 8px; margin: 15px 0;">
            <h4>ğŸ”¸ å¯¼å‡ºæ ¼å¼</h4>
            <div>
                <input type="radio" id="formatCSV" name="exportFormat" value="csv" checked>
                <label for="formatCSV">CSV (Excelå…¼å®¹)</label>
            </div>
            <div style="margin-top: 10px;">
                <input type="radio" id="formatJSON" name="exportFormat" value="json">
                <label for="formatJSON">JSON (ç¨‹åºå¤„ç†)</label>
            </div>
        </div>

        <div style="background: white; padding: 20px; border-radius: 8px; margin: 15px 0;">
            <h4>ğŸ”¸ é€‰æ‹©å¯¼å‡ºå­—æ®µ</h4>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px; max-height: 200px; overflow-y: auto;">
                <div><input type="checkbox" id="fieldName" checked> <label for="fieldName">å¤šè‚½åç§°</label></div>
                <div><input type="checkbox" id="fieldSequence" checked> <label for="fieldSequence">å¤šè‚½åºåˆ—</label></div>
                <div><input type="checkbox" id="fieldTarget" checked> <label for="fieldTarget">é¶ç‚¹</label></div>
                <div><input type="checkbox" id="fieldAffinity" checked> <label for="fieldAffinity">äº²å’ŒåŠ›</label></div>
                <div><input type="checkbox" id="fieldApplication" checked> <label for="fieldApplication">åº”ç”¨èŒƒå›´</label></div>
                <div><input type="checkbox" id="fieldClinical" checked> <label for="fieldClinical">ä¸´åºŠçŠ¶æ€</label></div>
            </div>
            <div style="margin-top: 10px;">
                <button onclick="selectAllFields()" style="padding: 5px 10px; margin-right: 10px;">å…¨é€‰</button>
                <button onclick="deselectAllFields()" style="padding: 5px 10px;">å…¨ä¸é€‰</button>
            </div>
        </div>
        
        <div style="text-align: center; margin: 30px 0;">
            <button onclick="exportData()" style="padding: 15px 30px; background: #27ae60; color: white; border: none; border-radius: 25px; font-size: 16px; cursor: pointer;">
                ğŸ“¥ å¼€å§‹å¯¼å‡º
            </button>
            <div id="exportStatus" style="margin-top: 15px;"></div>
        </div>
    </div>
</div>

<script>
const colors = {
    success: '#4CAF50',
    error: '#f44336',
    warning: '#ff9800'
};

const peptideData = "[{\"åºå·,å¤šè‚½åç§°,å¤šè‚½åºåˆ—N-Cç«¯,å¤šè‚½æ˜¯å¦æ˜¯å•ä¸€é¶ç‚¹ï¼ˆYesï¼ŒNoï¼ŒNAï¼‰,å¤šè‚½é¶ç‚¹1,å¤šè‚½é¶ç‚¹2,å¤šè‚½çš„ç±»å‹ï¼ˆL/D),,,,,,,,,,,,\":\"1,SCBP,ldvflyse,2,hCD24,hPD-L1,D,,,,,,,,,,,,\"},{\"åºå·,å¤šè‚½åç§°,å¤šè‚½åºåˆ—N-Cç«¯,å¤šè‚½æ˜¯å¦æ˜¯å•ä¸€é¶ç‚¹ï¼ˆYesï¼ŒNoï¼ŒNAï¼‰,å¤šè‚½é¶ç‚¹1,å¤šè‚½é¶ç‚¹2,å¤šè‚½çš„ç±»å‹ï¼ˆL/D),,,,,,,,,,,,\":\",,,,,,,,,,,,,,,,,,\"},{\"åºå·,å¤šè‚½åç§°,å¤šè‚½åºåˆ—N-Cç«¯,å¤šè‚½æ˜¯å¦æ˜¯å•ä¸€é¶ç‚¹ï¼ˆYesï¼ŒNoï¼ŒNAï¼‰,å¤šè‚½é¶ç‚¹1,å¤šè‚½é¶ç‚¹2,å¤šè‚½çš„ç±»å‹ï¼ˆL/D),,,,,,,,,,,,\":\",,,,,,,,,,,,,,,,,,\"},{\"åºå·,å¤šè‚½åç§°,å¤šè‚½åºåˆ—N-Cç«¯,å¤šè‚½æ˜¯å¦æ˜¯å•ä¸€é¶ç‚¹ï¼ˆYesï¼ŒNoï¼ŒNAï¼‰,å¤šè‚½é¶ç‚¹1,å¤šè‚½é¶ç‚¹2,å¤šè‚½çš„ç±»å‹ï¼ˆL/D),,,,,,,,,,,,\":\",,,,,,,,,,,,,,,,,,\"},{\"åºå·,å¤šè‚½åç§°,å¤šè‚½åºåˆ—N-Cç«¯,å¤šè‚½æ˜¯å¦æ˜¯å•ä¸€é¶ç‚¹ï¼ˆYesï¼ŒNoï¼ŒNAï¼‰,å¤šè‚½é¶ç‚¹1,å¤šè‚½é¶ç‚¹2,å¤šè‚½çš„ç±»å‹ï¼ˆL/D),,,,,,,,,,,,\":\",,,,,,,,,,,,,,,,,,\"},{\"åºå·,å¤šè‚½åç§°,å¤šè‚½åºåˆ—N-Cç«¯,å¤šè‚½æ˜¯å¦æ˜¯å•ä¸€é¶ç‚¹ï¼ˆYesï¼ŒNoï¼ŒNAï¼‰,å¤šè‚½é¶ç‚¹1,å¤šè‚½é¶ç‚¹2,å¤šè‚½çš„ç±»å‹ï¼ˆL/D),,,,,,,,,,,,\":\",,,,,,,,,,,,,,,,,,\"},{\"åºå·,å¤šè‚½åç§°,å¤šè‚½åºåˆ—N-Cç«¯,å¤šè‚½æ˜¯å¦æ˜¯å•ä¸€é¶ç‚¹ï¼ˆYesï¼ŒNoï¼ŒNAï¼‰,å¤šè‚½é¶ç‚¹1,å¤šè‚½é¶ç‚¹2,å¤šè‚½çš„ç±»å‹ï¼ˆL/D),,,,,,,,,,,,\":\",,,,,,,,,,,,,,,,,,\"}]";

const fieldMapping = {
    fieldName: 'å¤šè‚½åç§°',
    fieldSequence: 'å¤šè‚½åºåˆ—N_Cç«¯',
    fieldTarget: 'å¤šè‚½é¶ç‚¹',
    fieldAffinity: 'äº²å’ŒåŠ›',
    fieldApplication: 'å¤šè‚½çš„åº”ç”¨èŒƒå›´',
    fieldClinical: 'æ˜¯å¦ä¸´åºŠ'
};

function selectAllFields() {
    Object.keys(fieldMapping).forEach(fieldId => {
        const element = document.getElementById(fieldId);
        if (element) element.checked = true;
    });
}

function deselectAllFields() {
    Object.keys(fieldMapping).forEach(fieldId => {
        const element = document.getElementById(fieldId);
        if (element) element.checked = false;
    });
}

function showStatus(message, type) {
    const statusEl = document.getElementById('exportStatus');
    if (!statusEl) return;
    
    statusEl.innerHTML = `<span style="color: ${colors[type]}; font-weight: bold;">${message}</span>`;
    
    if (type === 'success') {
        setTimeout(() => {
            statusEl.innerHTML = '';
        }, 5000);
    }
}

function exportData() {
    const exportScope = document.querySelector('input[name="exportScope"]:checked')?.value || 'all';
    const exportFormat = document.querySelector('input[name="exportFormat"]:checked')?.value || 'csv';
    
    const selectedFields = Object.keys(fieldMapping).filter(fieldId => {
        const element = document.getElementById(fieldId);
        return element ? element.checked : false;
    }).map(fieldId => fieldMapping[fieldId]);
    
    if (selectedFields.length === 0) {
        showStatus('è¯·è‡³å°‘é€‰æ‹©ä¸€ä¸ªå­—æ®µ', 'error');
        return;
    }
    
    showStatus('æ­£åœ¨å‡†å¤‡å¯¼å‡ºæ•°æ®...', 'info');
    
    if (exportFormat === 'csv') {
        exportToCSV(peptideData, selectedFields);
    } else {
        exportToJSON(peptideData, selectedFields);
    }
}

function exportToCSV(data, fields) {
    try {
        let csvContent = fields.join(',') + '\n';
        
        data.forEach(item => {
            const row = fields.map(field => {
                let value = item[field] || '';
                if (typeof value === 'string' && (value.includes(',') || value.includes('"'))) {
                    value = '"' + value.replace(/"/g, '""') + '"';
                }
                return value;
            });
            csvContent += row.join(',') + '\n';
        });
        
        downloadFile(csvContent, 'peptide_data_export.csv', 'text/csv');
        showStatus('CSVå¯¼å‡ºæˆåŠŸï¼', 'success');
        
    } catch (error) {
        showStatus('å¯¼å‡ºå¤±è´¥ï¼š' + error.message, 'error');
    }
}

function exportToJSON(data, fields) {
    try {
        const filteredData = data.map(item => {
            const filteredItem = {};
            fields.forEach(field => {
                filteredItem[field] = item[field] || '';
            });
            return filteredItem;
        });
        
        const jsonContent = JSON.stringify(filteredData, null, 2);
        downloadFile(jsonContent, 'peptide_data_export.json', 'application/json');
        showStatus('JSONå¯¼å‡ºæˆåŠŸï¼', 'success');
        
    } catch (error) {
        showStatus('å¯¼å‡ºå¤±è´¥ï¼š' + error.message, 'error');
    }
}

function downloadFile(content, fileName, mimeType) {
    const blob = new Blob([content], { type: mimeType });
    const url = URL.createObjectURL(blob);
    const link = document.createElement('a');
    
    link.href = url;
    link.download = fileName;
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
    URL.revokeObjectURL(url);
}

document.addEventListener('DOMContentLoaded', function() {
    selectAllFields();
});
</script>

        </main>
        
        
        <footer style="text-align: center; padding: 30px 0; margin-top: 50px; color: #6c757d; border-top: 1px solid #e9ecef;">
            <p>Â© 2024 å¤šè‚½æ•°æ®åº“ - ä¸“ä¸šçš„å¤šè‚½ç ”ç©¶å¹³å°</p>
            <p>æŠ€æœ¯æ”¯æŒ: BioInformatics Team | ç‰ˆæœ¬: 1.0.0</p>
        </footer>
        
    </div>
    
    <script>
    
    document.addEventListener('DOMContentLoaded', function() {
        
        const mainContent = document.querySelector('main');
        if (mainContent) {
            mainContent.innerHTML = '<div class="loading"><div class="spinner"></div></div>' + mainContent.innerHTML;
            
            setTimeout(() => {
                const loadingElement = document.querySelector('.loading');
                if (loadingElement) {
                    loadingElement.style.display = 'none';
                }
            }, 500);
        }
        
        
        const handleMobileMenu = () => {
            if (window.innerWidth < 768) {
                
            }
        };
        
        window.addEventListener('resize', handleMobileMenu);
        handleMobileMenu();
    });
    </script>
</body>
</html>
